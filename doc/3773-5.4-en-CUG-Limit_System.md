# Limit System

**Customization Upgrade Guide**
Release 5.4

Area: Enterprise Risk Management

---
**Latest version of this document**

The latest version of this document can be found at https://docs.avaloq.com

**Feedback**

Please send any feedback to documentation@avaloq.com

Copyright Avaloq Evolution Ltd. All rights reserved.
The information in this document is provided for informational purposes only, is subject to change without notice and is not warranted to be error-free. No part of this document may be used, reproduced or transmitted in any form or by any means unless authorized by Avaloq Evolution Ltd through a written licence agreement. Further, this document does not grant any rights to, or in, the products mentioned therein and no rights of any kind relating to such products will be granted except pursuant to written agreements with Avaloq Evolution Ltd.
Avaloq Evolution Ltd. Allmendstr. 140 CH-8027 ZÃ¼rich | Switzerland

---
## Version history

| Version / Date          | Section | Description of the change              |
| ----------------------- | ------- | -------------------------------------- |
| 5.4v0/18 February 2022 |         | This is a new document for release 5.4 |


---
## Contents

* 1 Introduction
* 2 Upgrade steps

---
## 1 Introduction

This document describes the changes that you may need to make to your customization when you upgrade to Avaloq Core release 5.4 in order to preserve the existing functionality of the limit system.
As a result of the de-release in Avaloq Core 5.4 of the legacy asset evaluation engine, the following hobs filters (CODE_HOBS_FILTER.POS) have been de-released and are no longer supported:

* pos avm_res
* pos_avm_lst

Replacement filter types:

* pos avm res is replaced by pos md domn
* pos_avm_lst is replaced by pos_md_domn_class_lst

---
## 2 Upgrade steps

The new filter type pos md domn is based on the time series CODE_MD_DOMN code table and also requires a calculation scenario from the CODE_MD_SCEN code table. For most purposes, the "STD" scenario delivered in the kernel should suffice and only banks that have customized the new asset evaluation (using task 1848) with their own calculation scenarios should set their preferred calculation scenario.

Avaloq provides a migration script, HOBS, in the kernel that replaces the de-released hobs filter types in existing LIHI objects with their equivalent replacement filter types. Because the new asset evaluation engine is not equivalent in all aspects of the results of the legacy asset evaluation, some evaluation results are no longer included, and so they will be mapped to null by the migration script.

The following table describes the mapping that is performed by the migration script, and this should be checked thoroughly in order to manually correct potential null mappings in the existing LIHI objects for your Avaloq Core instances.

| code_avm_res | code_md_domn |
| ------------ | ------------ |
| ai           | Al           |
| convex       | Convex       |
| convexfv     | Convex       |
| convextocall | Convex       |
| convextoput  | Convex       |
| daystocall   | Daystomat    |
| delta        | Delta        |
| durfw        | $n/a$        |
| durfwfv      | $n/a$        |
| durfwtocall  | $n/a$        |
| durfwtoput   | $n/a$        |
| durmc        | Durmc        |
| durmod       | Durmod       |
| durmodfv     | Durmod       |
| durmodtocall | Durmod       |
| durmodtoput  | Durmod       |
| gamma        | Gamma        |
| oas          | OAS          |


| code_avm_res | code_md_domn |
| ------------ | ------------ |
| omega        | $n/a$        |
| rho          | Rho          |
| theta        | Theta        |
| yearstocall  | Yearstomat   |
| yearstomat   | Yearstomat   |
| yearstoput   | Yearstomat   |
| yieldfv      | YTM          |
| yieldmv      | YTM          |
| yieldtocall  | YTM          |
| yieldtoput   | YTM          |


**Table 1: Mapping performed by the migration script**

As part of this de-release, the old filter type's filter value type code avm res has been replaced with the new filter type's filter value type code md domn in the report task TASK_LIHI_LIST (task ID: 2078). As a result, you must update your customized TASK TEMPL sources in case they were referencing the de-released task parameter i hobs filter avm_res and replace them with the new parameter i hobs filter_md domn.