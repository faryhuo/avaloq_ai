# Client Credit Risk

**Customization Upgrade Guide**
Release 5.7

Area: Client Credit Risk

---
**Latest version of this document**

The latest version of this document can be found at https://docs.avaloq.com

**Feedback**

Please send any feedback to documentation@avaloq.com

Copyright Avaloq Group Ltd. All rights reserved.
The information in this document is provided for informational purposes only, is subject to change without notice and is not warranted to be error-free. No part of this document may be used, reproduced or transmitted in any form or by any means unless authorized by Avaloq Group Ltd through a written licence agreement. Further, this document does not grant any rights to, or in, the products mentioned therein and no rights of any kind relating to such products will be granted except pursuant to written agreements with Avaloq Group Ltd.
Avaloq Group Ltd. Allmendstr. 140 CH-8027 ZÃ¼rich Switzerland

---
## Version history

| Version / Date     | Section | Description of the change |
| ------------------ | ------- | ------------------------- |
| 5.7v0/22 April 2024 |         | This is a new document.   |

---
## Contents

* 1 Introduction
    * 1.1 "Collat_lot_distr_type_id": no_distr added to code_collat_val_type table for CLTAV
    * 1.2 Upgrade instructions

---
## 1 Introduction

This document describes the changes you may need to make to your customization when you upgrade to Avaloq Core Platform Release 5.5 or higher as a result of a change in the Client Credit Risk module in Release 5.5.

### 1.1 "Collat_lot_distr_type_id": no_distr added to code_collat_val_type table for CLTAV

For performance reasons, `lot_distr_type_id 'no_distr'` has been added to the `code_collat_val_type` table in kernel for collateral valuation type CLTAV. Due to this change, a catch-all rule with the result 'DFLT' for the result type "LOT_DISTR" must be added in the collateral rule customization.

### 1.2 Upgrade instructions

The upgrade is only needed if you are using/calculating collateral pillars of valuation type "CLTAV" and you have so far not set up any rules for the result type "LOT_DISTR".

1.  Add a catch-all rule for the result type "LOT_DISTR" with the result "DFLT" in the collateral rule customization.
    ```sql
    begin
        -- insert rules
        collat_rule_ld#.init(i_rule_set => 'DFLT', i_bu => null, i_add_rule_set => true);
        collat_rule_ld#.set_rule_ctx(i_collat_val_type=>'CLTAV', i_collat_rule_res_type=>'LOT_DISTR');
        collat_rule_ld#.rule_ins (collat_rule_res_type=>'LOT_DISTR', collat_lot_distr=>'DFLT', prio=> '0000', descn=>'Default Distribution for CLTAV');
    
        -- load rules
        if not install#.install_mode#is_rel then
            collat_rule_ld#.ld(i_set=>'DFLT', i_bu => null);
        end if;
    end;
    /
    ```
2.  Load the collateral rules.